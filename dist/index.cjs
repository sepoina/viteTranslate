var e=require("path"),n=require("fnv1a"),a=require("fs");function l(e){return e&&"object"==typeof e&&"default"in e?e:{default:e}}var r=/*#__PURE__*/l(e),t=/*#__PURE__*/l(n),o=/*#__PURE__*/l(a);function i(e,n){var a,l;if(null!=e&&null!=(a=e.node)&&a.value&&/_%_(.*?)_%_/.test(e.node.value)){var r=null==(l=/_%_(.*?)_%_/.exec(e.node.value))?void 0:l[1];if(r){var t=s(r,n);e.node.value=u(e.node.value,t,r),e.node.extra.rawValue&&(e.node.extra.rawValue=u(e.node.extra.rawValue,t,r)),e.node.extra.raw&&(e.node.extra.raw=u(e.node.extra.raw,t,r))}}}function u(e,n,a){return e.replace(/_%_(.*?)_%_/,"_<_"+n+"_/_"+a+"_>_")}function s(e,n){var a=r.default.parse(n.filename).name+"_"+t.default(e).toString(36);return globalThis.TranslateService.baseLng[a]=e,a}exports.babelTranslate=function(e){var n=e.types;return{visitor:{StringLiteral:i,JSXText:i,TemplateElement:i,JSXOpeningElement:function(e,a){if("Translate"===e.node.name.name){var l=e.node.attributes.find(function(e){var n;return"data-translate"===(null==e||null==(n=e.name)?void 0:n.name)});if(!l&&!e.node.attributes.find(function(e){return"c"===(null==e?void 0:e.name.name)})){var r,t,o,i,u=e.node.attributes.find(function(e){var n;return"t"===(null==e||null==(n=e.name)?void 0:n.name)}),d=u?!!(i=e.node.attributes.find(function(e){var n;return"t"===(null==e||null==(n=e.name)?void 0:n.name)}))&&("StringLiteral"===(null==i||null==(r=i.value)?void 0:r.type)?i.value.value:"JSXExpressionContainer"===(null==i||null==(t=i.value)?void 0:t.type)&&"StringLiteral"===(null==i||null==(o=i.value)||null==(o=o.expression)?void 0:o.type)&&i.value.expression.value):function(e){var n;if(1===(null==e||null==(n=e.container)||null==(n=n.children)?void 0:n.length)){var a,l=e.container.children[0];return"JSXText"===l.type?l.value:!("JSXExpressionContainer"!==l.type||null==l||null==(a=l.expression)||!a.value)&&l.expression.value}return!1}(e);if(!1===d)throw"Errore, Translate deve contenere solo stringhe";var c=s(d,a),v=n.jSXAttribute(n.jSXIdentifier("data-translate"),n.stringLiteral(c));e.node.attributes.push(v)}}}}}},exports.rollupTranslate=function(e){return{name:"onRollupTranslate",buildStart:{sequential:!0,order:"pre",handler:function(){globalThis.TranslateService=e,globalThis.TranslateService.baseLng={__lngVersion__:Date.now()},console.log("Preparo il servizio traduzioni.")}},buildEnd:{sequential:!0,order:"post",handler:function(){!function(){var e=globalThis.TranslateService.file,n=globalThis.TranslateService.dist;console.log("TRANSLATE ---------------------------------------------"),console.log("Carico traduzione base.");try{o.default.readFile(e,"utf8",function(a,l){var r={newest:!0,changed:!0},t=null;a?(console.log("Non esiste ancora il file "+e+", tento di crearlo"),t=globalThis.TranslateService.baseLng):r=function(e,n){var a={changed:!1,deleted:0,added:0};for(var l in e)l in n||(delete e[l],a.changed=!0,a.deleted+=1);for(var r in n)r in e||(e[r]=n[r],a.changed=!0,a.added+=1);return a.changed&&(e.__lngVersion__=n.__lngVersion__),a}(t=JSON.parse(l),globalThis.TranslateService.baseLng),r.changed?(console.log("Update avvenuto: "+(r.newest?"Nuovo file,":"("+r.added+" agginte, "+r.deleted+" rimosse)")+" salvo."),o.default.writeFile(e,JSON.stringify(t,null,2),"utf8",function(a){a?console.error("Errore durante la scrittura su "+e,a):(console.log("Dati scritti con successo su "+e),o.default.copyFile(e,n,function(e){e||console.log("Copiato con successo su "+n),console.log("END TRANSLATE ---------------------------------------------")}))})):(console.log("Nessun cambiamento."),console.log("END TRANSLATE ---------------------------------------------"))})}catch(n){return void console.error("Errore l'elaborazione di "+e+", cancellalo",n)}}()}}}};
//# sourceMappingURL=index.cjs.map
